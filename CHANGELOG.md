# Changelog

## v1.3 – Обновление Иконки Приложения (04 января 2026)

* **Новый современный дизайн иконки:**
  * Установлена новая иконка приложения высокого разрешения (Retina-ready).
  * Исправлены проблемы с прозрачностью и форматом.
  * Удалены устаревшие файлы иконок (.png, .ico).
* **Технические улучшения:**
  * Иконка теперь корректно собрана в формате ICNS со всеми необходимыми размерами (от 16x16 до 1024x1024).

## v1.2 – Исправление форматирования Markdown (03 января 2026)

* **Исправлена проблема с обратными слешами в ссылках:**
  * **Корневая причина:** QTextEdit сохраняет ссылки как Markdown-текст (`[text](url)`) внутри HTML, а не как теги `<a>`. Функция `_escape_md()` экранировала символы `[` и `]`, превращая `[INWAYUP | БИЗНЕС](url)` в `\[INWAYUP | БИЗНЕС\](url)`, что Telegram отображал как видимые обратные слеши.
  * **Решение:** Модифицирована функция `_escape_md()` для распознавания готовых Markdown-ссылок в тексте и защиты их от экранирования. Ссылки временно заменяются на плейсхолдеры, затем восстанавливаются после экранирования остального текста.
  * **Результат:** Ссылки в сообщениях теперь отображаются корректно без лишних обратных слешей.
  * Исправление применено в `main.py` и `mini_broadcast.py`.

## v1.1 – Улучшение обработки ошибок (03 января 2026)

* **Улучшение UX (User Experience) в логах рассылки:**
  * Реализован механизм "человекочитаемого" перевода технических ошибок Telegram API.
  * Теперь вместо кодов (например, `406 ALLOW_PAYMENT_REQUIRED`) пользователь видит понятные сообщения на русском языке (например, "Требуется оплата (Telegram Stars) — пропуск").
  * Обработаны ошибки: `ALLOW_PAYMENT_REQUIRED`, `CHAT_WRITE_FORBIDDEN`, `USER_BANNED_IN_CHANNEL`, `PEER_ID_INVALID`, `SLOWMODE_WAIT`, `CHANNEL_PRIVATE`, `INPUT_USER_DEACTIVATED`.
* **Технические изменения:**
  * Изменения применены как к `MiniBroadcastApp` (`mini_broadcast.py`), так и к основной рассылке `OptimizedBroadcastWorker` (`main.py`).
  * Полный технический текст ошибки по-прежнему сохраняется в отладочные файлы (`auth.log`, `mini_debug.jsonl`) для диагностики.

## v1.0-stable – исправление авторизации (18 июня 2025)

* Полностью переработан поток авторизации (`TelegramAuthWorker`):
  * `send_code` вызывается ровно один раз, соединение не разрывается до конца входа.
  * Добавлены сигналы `submit_code` и `submit_password` для приёма данных из GUI.
  * Исключены бесконечные циклы запроса кода и пароля.
* GUI (`handle_auth_response`):
  * Теперь не создаёт новые потоки, а передаёт данные в уже работающий.
  * Корректно обрабатывает `PHONE_CODE_INVALID`, `PHONE_CODE_EXPIRED`, `PASSWORD_INVALID`.
* Исправлена ошибка «database is locked» за счёт исключения параллельных потоков и окон.
* Добавлена метка Git `v1.0-stable` для отката к этой версии.

---
Дальнейшие изменения фиксируйте новыми разделами выше этого блока. 